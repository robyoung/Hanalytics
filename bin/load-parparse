#!/usr/bin/env python
"""
> load-parlparse --root-dir=./data/parlparse/commons --workers=4
"""
import argparse, logging, sys, os
import multiprocessing as mp
sys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(__file__), '..')))

from hanalytics.loaders.parlparse import ParlparseCommonsDebatesLoader



logger = logging.getLogger()
logger.setLevel(logging.DEBUG)
logger.addHandler(logging.StreamHandler())


parser = argparse.ArgumentParser(description="Load hansard data from various sources.")
# TODO: add log level
parser.add_argument('-r', '--root-dir', dest="root_dir", type=str,
                    help = "The location of the parparse commons hansard xml documents.")
parser.add_argument('-w', '--workers', dest="num_workers", type=int, default=mp.cpu_count() + 1,
                    help = "The number of workers to use, defaults to the number of processors plus one.")
args = parser.parse_args()

loader = ParlparseCommonsDebatesLoader(root_dir=args.root_dir, num_workers=args.num_workers)

loader.start()